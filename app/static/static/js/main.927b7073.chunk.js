(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,a){e.exports=a(34)},25:function(e,t,a){},27:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(17),l=a.n(s),o=a(35),r=(a(25),a(7)),c=a(8),u=a(11),m=a(9),h=a(10),d=a(2),b=a(37),f=a(36),v=(a(27),a(16),a(12)),g={UNKNOWN:"UNKNOWN",WATER:"WATER",BOMB:"BOMB",NUMBER:"NUMBER"},E={HIDDEN:"HIDDEN",REVEALED:"REVEALED"},O=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={gameID:e.gameID,tileIndex:e.tileIndex,tileRow:e.tileColumn,tileColumn:e.tileRow,tileID:e.tileID,tileType:g.UNKNOWN,tileStatus:E.HIDDEN,tileNeighbours:0,gameOver:e.gameOver,winState:!1,killFunction:e.killGame,revealFunction:e.revealTile,notifyFunction:e.notifyOfReveal},a.interactWithTile=a.interactWithTile.bind(Object(d.a)(Object(d.a)(a))),a.updateTileStatus=a.updateTileStatus.bind(Object(d.a)(Object(d.a)(a))),a.disabledIfDead=a.disabledIfDead.bind(Object(d.a)(Object(d.a)(a))),a.winGame=a.winGame.bind(Object(d.a)(Object(d.a)(a))),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"updateTileStatus",value:function(e,t,a){if(this.state.tileStatus!==E.REVEALED){switch(e){case g.BOMB:this.setState({tileType:e,tileNeighbours:t,tileStatus:E.REVEALED,gameOver:!0}),!1===this.state.winState&&this.state.killFunction();break;case g.WATER:this.setState({tileType:e,tileNeighbours:t,tileStatus:E.REVEALED}),a||this.state.revealFunction();break;default:this.setState({tileType:e,tileNeighbours:t,tileStatus:E.REVEALED})}this.state.notifyFunction()}}},{key:"interactWithTile",value:function(){var e=this;fetch("http://www.modesto.io/minesweeper",{method:"post",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"move",tileIndex:this.state.tileIndex,tileID:this.state.tileID,gameID:this.state.gameID})}).then(function(e){return e.json()}).then(function(t){t.tileType?e.updateTileStatus(t.tileType,t.tileNeighbours,!1):console.log("Warning: Responsed does not contain what we want :/")},function(e){console.log("\xaf\\_(\u30c4)_/\xaf : "+e)})}},{key:"selectImageFromState",value:function(){switch(this.state.tileType){case g.UNKNOWN:return i.a.createElement(v.a,{icon:"question"});case g.WATER:return i.a.createElement(v.a,{icon:"tint"});case g.BOMB:return this.state.winState?i.a.createElement(v.a,{icon:"smile"}):i.a.createElement(v.a,{icon:"bomb"});case g.NUMBER:return i.a.createElement("span",null,"(",this.state.tileNeighbours,")");default:return i.a.createElement(v.a,{icon:"times"})}}},{key:"selectButtonModifiersFromState",value:function(){switch(this.state.tileType){case g.UNKNOWN:return"btn btn-outline";case g.WATER:return"btn btn-outline-primary disabled";case g.BOMB:return this.state.winState?"btn btn-outline-warning disabled":"btn btn-outline-danger disabled";case g.NUMBER:return"btn btn-outline-success disabled";default:return"btn btn-outline-info disabled"}}},{key:"disabledIfDead",value:function(){if(this.state.gameOver)return"disabled"}},{key:"winGame",value:function(){this.setState({winState:!0}),this.state.tileStatus===E.HIDDEN&&this.updateTileStatus(g.BOMB,0,!0)}},{key:"render",value:function(){return this.state.tileStatus===E.REVEALED?i.a.createElement("div",null,i.a.createElement("button",{id:this.state.tileID,className:this.selectButtonModifiersFromState(),disabled:!0},this.selectImageFromState())):i.a.createElement("div",null,i.a.createElement("button",{id:this.state.tileID,className:this.selectButtonModifiersFromState(),onClick:this.interactWithTile},this.selectImageFromState()))}}]),t}(n.Component),p=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={gameID:"",haveGameData:!1,width:0,height:0,hiddenBombs:0,hiddenBlocks:0,gameTime:0,gameOver:!1,winState:!1},a.killGame=a.killGame.bind(Object(d.a)(Object(d.a)(a))),a.recallGame=a.recallGame.bind(Object(d.a)(Object(d.a)(a))),a.increaseRevealedCount=a.increaseRevealedCount.bind(Object(d.a)(Object(d.a)(a))),a.tileRefList=[],""!==e.gameID&&void 0!==e.gameID&&(a.state.gameID=e.gameID,a.state.gameOver=!1,a.recallGame()),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.title="Modesto.io - Minesweeper"}},{key:"killGame",value:function(){this.recallGame(),!0!==this.state.gameOver&&this.setState({gameOver:!0,winState:!1})}},{key:"requestNewGame",value:function(){var e=this;this.cleanSweepMatrix(),fetch("http://www.modesto.io/minesweeper",{method:"post",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"newgame"})}).then(function(e){return e.json()}).then(function(t){console.log("Got Result!"),e.setState({haveGameData:!0,width:t.columnCount,height:t.rowCount,hiddenBombs:t.hiddenBlockCount,hiddenBlocks:t.columnCount*t.rowCount,gameID:t.gameID,gameOver:!1}),e.buildGame()},function(e){})}},{key:"cleanSweepMatrix",value:function(){this.setState({gameID:"",haveGameData:!1,width:0,height:0,gameTime:0,gameOver:!0})}},{key:"recallGame",value:function(){var e=this;!0!==this.state.gameOver&&(console.log("Treating Recall Event"),fetch("http://www.modesto.io/minesweeper",{method:"post",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"recall",gameID:this.state.gameID})}).then(function(e){return e.json()}).then(function(t){(0===e.tileRefList.length&&(e.setState({haveGameData:!0,width:t.columnCount,height:t.rowCount,hiddenBombs:t.hiddenBlockCount,hiddenBlocks:t.columnCount*t.rowCount,gameID:t.gameID,gameOver:!1,winState:!1}),e.buildGame()),t.tileList)&&t.tileList.forEach(function(t){for(var a=0;a<e.tileRefList.length;a++)null!=e.tileRefList[a]&&e.tileRefList[a].state.tileIndex===t.tileIndex&&e.tileRefList[a].updateTileStatus(t.tileType,t.tileNeighbours,!0)})},function(e){}))}},{key:"increaseRevealedCount",value:function(){if(this.setState({hiddenBlocks:this.state.hiddenBlocks-1}),this.state.hiddenBlocks<=this.state.hiddenBombs&&!1===this.state.gameOver){this.setState({gameOver:!0,winState:!0});for(var e=0;e<this.tileRefList.length;e++)null!=this.tileRefList[e]&&this.tileRefList[e].winGame()}}},{key:"buildGame",value:function(){var e=this;if(!this.state.haveGameData)return i.a.createElement("div",null,"No Ongoing Game :)");for(var t=[],a=0;a<this.state.height;a++){for(var n=[],s=0;s<this.state.width;s++){var l=a*this.state.width+s,o=this.state.gameID+"_tile_"+l;n.push(i.a.createElement("td",{key:o},i.a.createElement(O,{tileIndex:l,tileRow:a,tileColumn:s,tileID:o,gameID:this.state.gameID,killGame:this.killGame,gameOver:this.state.gameOver,revealTile:this.recallGame,notifyOfReveal:this.increaseRevealedCount,ref:function(t){return e.tileRefList.push(t)}})))}t.push(i.a.createElement("tr",{key:"row_"+a},n))}return i.a.createElement("table",{className:"borderless"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{colSpan:""+this.state.width},"GameID: ",i.a.createElement("a",{href:this.getGameLink()},this.getGameName())))),i.a.createElement("tbody",null,t))}},{key:"getGameName",value:function(){if(""!==this.state.gameID)return this.state.gameID}},{key:"getGameLink",value:function(){return"http://modesto.io/minesweeper/"+this.state.gameID}},{key:"render",value:function(){return i.a.createElement("div",{className:"d-inline-flex p-2 btn-group"},this.buildGame())}}]),t}(n.Component),w=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={gameOver:!0,resetGameFunction:e.resetGameFunction,reloadGameFunction:e.reloadGameFunction,hiddenTiles:0},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"renderGameStatus",value:function(){this.state.gameOver}},{key:"render",value:function(){return console.log(this.state.hiddenTiles,this.state.gameOver),0===this.state.hiddenTiles||!0!==this.state.gameOver?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"btn-group"},i.a.createElement("button",{id:"startButton",className:"btn btn-outline-primary btn-sm",onClick:this.state.resetGameFunction}," New Game ")),this.renderGameStatus()):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"btn-group"},i.a.createElement("button",{id:"startButton",className:"btn btn-outline-primary btn-sm",onClick:this.state.resetGameFunction}," New Game "),i.a.createElement("button",{id:"reloadButton",className:"btn btn-outline-primary btn-sm",onClick:this.state.reloadGameFunction},i.a.createElement(v.a,{icon:"sync-alt"}))),this.renderGameStatus())}}]),t}(n.Component),y=a(13),D=a(5);y.b.add(D.a,D.k,D.i,D.g,D.c,D.d,D.b,D.e,D.j,D.f,D.h);var G=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).styles={justifyContent:"center",border:"none",top:"50%",left:"50%",position:"absolute",transform:"translate(-50%, -50%)"},a.resetGame=a.resetGame.bind(Object(d.a)(Object(d.a)(a))),a.reloadGame=a.reloadGame.bind(Object(d.a)(Object(d.a)(a))),a.mainMenu=a.mainMenu.bind(Object(d.a)(Object(d.a)(a))),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"resetGame",value:function(){this.MS.requestNewGame()}},{key:"reloadGame",value:function(){this.MS.recallGame()}},{key:"mainMenu",value:function(e){var t=this,a=e.match;return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"row col-sm-push-4 col-xs-push-4"},i.a.createElement("div",{className:"table-responsive-sm",style:this.styles},i.a.createElement(p,{gameID:a.params.gameID,ref:function(e){t.MS=e}}),i.a.createElement("br",null),i.a.createElement(w,{resetGameFunction:this.resetGame,reloadGameFunction:this.reloadGame}))))}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(b.a,null,i.a.createElement(f.a,{path:"/minesweeper/:gameID",component:this.mainMenu}),i.a.createElement(f.a,{path:"",component:this.mainMenu})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(o.a,null,i.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[20,2,1]]]);
//# sourceMappingURL=main.927b7073.chunk.js.map